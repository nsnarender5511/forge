commands:
  - name: commit
    description: Analyzes and organizes code changes into meaningful, well-structured commits
  - name: pull-request
    description: Analyzes code changes, generates comprehensive PR descriptions with linked issues.
  - name: docs
    description: Automatically synchronize documentation from codebase to website
    value: |
      Automatically scan and synchronize documentation from the codebase's @docs folder to the website's supporting files.

variables:
  mode: ACT

# Define model anchors with simpler, purpose-based names
models:
  # Role-based model definitions - easy to swap implementation
  - &advanced_model anthropic/claude-3.5-sonnet
  - &standard_model anthropic/claude-3.5-haiku

agents:
  - id: title-generation
    tool_supported: true
    model: *standard_model
    hide_content: true
    system_prompt: "{{> system-prompt-title-generator.hbs }}"
    user_prompt: <technical_content>{{event.value}}</technical_content>
    tools:
      - tool_forge_event_dispatch
    subscribe:
      - user_task_init

  - id: help_agent
    model: *advanced_model
    hide_content: true
    system_prompt: "{{> system-prompt-help.hbs }}"
    user_prompt: <query>{{event.value}}</query>
    tool_supported: true
    tools:
      - tool_forge_display_show_user
    subscribe:
      - user_help_query

  - id: software-engineer
    tool_supported: true
    model: *advanced_model
    system_prompt: "{{> system-prompt-engineer.hbs }}"
    user_prompt: |-
      <task>{{event.value}}</task>
      <mode>{{variables.mode}}</mode>
    ephemeral: false
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_create
      - tool_forge_fs_remove
      - tool_forge_fs_patch
      - tool_forge_process_shell
      - tool_forge_net_fetch
      - tool_forge_fs_search
      - tool_forge_display_show_user
    subscribe:
      - user_task_init
      - user_task_update
    max_walker_depth: 1

  - tool_supported: true
    id: github-issue-planner
    model: *advanced_model
    system_prompt: "{{> system-prompt-github-issue-planner.hbs }}"
    user_prompt: |-
      <event>{{event.name}}</event>
      <value>{{event.value}}</value>
      <mode>PLAN</mode>
    ephemeral: false
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_create
      - tool_forge_fs_remove
      - tool_forge_fs_patch
      - tool_forge_process_shell
      - tool_forge_net_fetch
      - tool_forge_fs_search
      - tool_forge_event_dispatch
    subscribe:
      - fix_issue
    max_walker_depth: 4

  - tool_supported: true
    id: github-pr-updater
    model: *advanced_model
    system_prompt: "{{> system-prompt-github-pr-updater.hbs }}"
    user_prompt: |-
      <event>{{event.name}}</event>
      <value>{{event.value}}</value>
      <mode>ACT</mode>
    ephemeral: false
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_create
      - tool_forge_fs_remove
      - tool_forge_fs_patch
      - tool_forge_process_shell
      - tool_forge_net_fetch
      - tool_forge_fs_search
      - tool_forge_event_dispatch
    subscribe:
      - update_pr
    max_walker_depth: 4

  - tool_supported: true
    id: github-review-handler
    model: *advanced_model
    system_prompt: "{{> system-prompt-github-review-handler.hbs }}"
    user_prompt: |-
      <event>{{event.name}}</event>
      <value>{{event.value}}</value>
      <mode>ACT</mode>
    ephemeral: false
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_create
      - tool_forge_fs_remove
      - tool_forge_fs_patch
      - tool_forge_process_shell
      - tool_forge_net_fetch
      - tool_forge_fs_search
      - tool_forge_event_dispatch
    subscribe:
      - fix-review-comment
    max_walker_depth: 4

  - tool_supported: true
    id: git-commit
    model: *advanced_model
    hide_content: true    
    ephemeral: true
    system_prompt: "{{> system-prompt-git-commit.hbs }}"
    user_prompt: "Go ahead and make the commit, {{event.value}}"
    tools:
      - tool_forge_process_shell
    subscribe:
      - commit

  - tool_supported: true
    id: github-plan-reviser
    model: *advanced_model
    system_prompt: "{{> system-prompt-github-plan-reviser.hbs }}"
    user_prompt: |-
      <event>{{event.name}}</event>
      <value>{{event.value}}</value>
      <mode>PLAN</mode>
    ephemeral: false
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_create
      - tool_forge_fs_remove
      - tool_forge_fs_patch
      - tool_forge_process_shell
      - tool_forge_net_fetch
      - tool_forge_fs_search
      - tool_forge_event_dispatch
    subscribe:
      - revise_plan
    max_walker_depth: 4

  - tool_supported: true
    id: github-pull-request-create
    hide_content: true
    model: *advanced_model
    ephemeral: true
    system_prompt: "{{> system-prompt-github-pull-request.hbs }}"
    user_prompt: "Go ahead and create a PR"
    tools:
      - tool_forge_process_shell
    subscribe:
      - pull-request

  # Document Syncer Agent: Automates synchronization between codebase docs and Docusaurus website
  # Commented out in favor of the multi-agent documentation system
  # - id: doc-syncer
  #   tool_supported: true      # Enables access to file system operations
  #   model: *advanced_model    # Uses the more capable model for complex documentation analysis
  #   max_walker_depth: 1024    # Allows deeper directory traversal for finding all documentation files
  #   system_prompt: "{{> system-prompt-doc-syncer.hbs }}"  # Template defining agent behavior
  #   tools:
  #     - tool_forge_filesystem_read
  #     - tool_forge_filesystem_write
  #     - tool_forge_filesystem_list
  #     - tool_forge_process_shell
  #     - tool_forge_fs_search     # For finding specific patterns in files
  #     - tool_forge_fs_patch      # For applying targeted changes to files
  #     - tool_forge_net_fetch     # For validating external links
  #     - tool_forge_display_show_user  # For detailed user feedback on large operations
  #   subscribe:
  #     - docs                  # Triggered by the /docs command

  # Documentation Synchronization Multi-Agent System
  
  # Doc Coordinator Agent: Orchestrates the entire documentation synchronization process
  - id: doc-coordinator
    tool_supported: true
    model: *advanced_model
    max_walker_depth: 1024
    system_prompt: "{{> system-prompt-doc-coordinator.hbs }}"
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_list
      - tool_forge_fs_search
      - tool_forge_process_shell
      - tool_forge_event_dispatch
      - tool_forge_display_show_user
    subscribe:
      - docs
      - docs-content-analyzed
      - docs-docusaurus-analyzed
      - docs-ui-analyzed
      - docs-css-analyzed
      - docs-execution-complete
      - docs-verification-complete
      - docs-implementation-complete
      - docs-iteration-decision
      - docs-iteration-complete

  # Doc Content Syncer Agent: Analyzes documentation content and structure
  - id: doc-content-syncer
    tool_supported: true
    model: *advanced_model
    max_walker_depth: 1024
    system_prompt: "{{> system-prompt-doc-content-syncer.hbs }}"
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_list
      - tool_forge_fs_search
      - tool_forge_event_dispatch
      - tool_forge_display_show_user
    subscribe:
      - docs-analyze-content

  # Docusaurus Expert Agent: Manages Docusaurus-specific configurations
  - id: docusaurus-expert
    tool_supported: true
    model: *advanced_model
    max_walker_depth: 1024
    system_prompt: "{{> system-prompt-docusaurus-expert.hbs }}"
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_list
      - tool_forge_fs_search
      - tool_forge_event_dispatch
      - tool_forge_display_show_user
    subscribe:
      - docs-analyze-docusaurus

  # UI Design Expert Agent: Optimizes documentation UI elements
  - id: ui-design-expert
    tool_supported: true
    model: *advanced_model
    max_walker_depth: 1024
    system_prompt: "{{> system-prompt-ui-design-expert.hbs }}"
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_list
      - tool_forge_fs_search
      - tool_forge_event_dispatch
      - tool_forge_display_show_user
    subscribe:
      - docs-analyze-ui

  # CSS Expert Agent: Enhances documentation styling
  - id: css-expert
    tool_supported: true
    model: *advanced_model
    max_walker_depth: 1024
    system_prompt: "{{> system-prompt-css-expert.hbs }}"
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_list
      - tool_forge_fs_search
      - tool_forge_event_dispatch
      - tool_forge_display_show_user
    subscribe:
      - docs-analyze-css

  # Doc Runner Agent: Executes documentation synchronization operations
  - id: doc-runner
    tool_supported: true
    model: *advanced_model
    max_walker_depth: 1024
    system_prompt: "{{> system-prompt-doc-runner.hbs }}"
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_create
      - tool_forge_fs_patch
      - tool_forge_fs_list
      - tool_forge_fs_search
      - tool_forge_process_shell
      - tool_forge_event_dispatch
      - tool_forge_display_show_user
    subscribe:
      - docs-execute

  # Doc Verifier Agent: Validates documentation synchronization results
  - id: doc-verifier
    tool_supported: true
    model: *advanced_model
    max_walker_depth: 1024
    system_prompt: "{{> system-prompt-doc-verifier.hbs }}"
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_list
      - tool_forge_fs_search
      - tool_forge_event_dispatch
      - tool_forge_display_show_user
    subscribe:
      - docs-verify
      
  # Doc Change Planner Agent: Plans changes based on verification feedback
  - id: doc-change-planner
    tool_supported: true
    model: *advanced_model
    max_walker_depth: 1024
    system_prompt: "{{> system-prompt-doc-change-planner.hbs }}"
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_list
      - tool_forge_fs_search
      - tool_forge_event_dispatch
      - tool_forge_display_show_user
    subscribe:
      - docs-plan-changes
      
  # Change Implementer Agent: Implements planned changes in the feedback loop
  - id: change-implementer
    tool_supported: true
    model: *advanced_model
    max_walker_depth: 1024
    system_prompt: "{{> system-prompt-change-implementer.hbs }}"
    tools:
      - tool_forge_fs_read
      - tool_forge_fs_create
      - tool_forge_fs_patch
      - tool_forge_fs_remove
      - tool_forge_fs_list
      - tool_forge_fs_search
      - tool_forge_process_shell
      - tool_forge_event_dispatch
      - tool_forge_display_show_user
    subscribe:
      - docs-implement-changes
